---
layout: default
title: Часть 1. Начало
parent: Обработка заданий и подготовка запросов
nav_order: 1
---
# Часть 1. Начало разработки модуля обработки заданий и подготовки запросов
{: .no_toc }  
В [части 5. Разработка mpg](./PGConnection5.md) мы закончили разрабатывать прототип модуля Выполнения звпросов к PostgreSQL и обсудили модульную систему. Одной из частей такой комплексной модульной системы является модуль Обработки заданий и подготовки запросов, который подготавливает запрос и помещает его в очередь запросов модуля Выполнения запросов.  
  
Сейчас рассмотрим и разработаем прототип модуля Подготовки запросов (далее - Модуль или Подсистема). Когда в тексте встречается термин Программа, то имеется ввиду целостная система, объединяющая все модули.
## Содержание
{: .no_toc }  
1. TOC
{:toc}

# Общие положения 
Что Модуль дожен делать:
- Модуль должен предоставлять конечному пользователю возможность самому создавать и изменять структуру данных. Эта структура данных является нелинейной, т.е. не просто набор столбцов какой-то сущности, но и набор связей между сущностями.  
- Возможность создавать и изменять структуру данных должна быть простой и понятной.  
- Структура создаваемой БД хранится рядом с данными в той же БД.  
- Модуль должен предоставлять конечному пользователю возможность добавлять и изменять данные, соответствующие указанной структуре.
- Ну и, Модуль должен позволять делать выборки данных. Здесь пока затрудняемся выдвинуть требование простоты и понятности.
  

# Структуры данных и отношения
Сложность структуры ланных определяется отношениями между сущностями структуры. Сущности структуры - это элементы предметной области, которую мы автоматизируем. В результате опыта работы в разных предметных областях мы попытались выделить несколько, наиболее часто встречающихся отношений между сущностями. Этот список отношений не полный, и кончно же будет расширяться с ростом системы.  
Отношения также влияют на представление предметной области (грубо сказать - интерфейс пользователя). Конечно же нельзя интерфейс пользователя проецировать на структуру базы данных. Мы не будем этого делать, просто наглядное представление порой бывает лучше тысячи слов.  В каждом разделе, описывая примеры, будем показывать как это отнощение воспринимается с точки зрения предметной области.
  
Далее рассмотрим отношения и примеры их использования.  

## 1. Ссылка
Далее выделены две ссылки, с точки зрения системы, которые являются абсолютно идентичными, но различаются с точки зрения предметной области.
### 1.1. Простая ссылка
![ref](img/ref.png)  
В этом примере показана простая ссылка: ```Роль пользователя``` является ролью, настроенной для организации (ссылается на ```Роль организации```), которой принадлежит пользователь. Здесь показана ситуация, когда у сущности Роль пользователя есть два ключевых поля ```id``` и ```userId```. Также у Роли организации есть два ключевых поля ```id``` и ```entityId```.   
  
Вот как видится это с точки зрения **предметной области**:  
![ref DO](img/ref_DO.png)  
  
**Возможные выборки**:
- показать всех пользователей, обладающих конкретной ролью организации.
  
### 1.2. Ссылка на справочник
![ref ref](img/ref_ref.png)  
В этом примере показана простая ссылка: ```Документ``` имеет тип Приказ из списка ```Вид документа```. 
  
Вот как видится это с точки зрения **предметной области**:  
![ref ref DO](img/ref_ref_DO.png)  
  
**Возможные выборки**:
- показать все документы этого типа.
